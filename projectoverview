Microservice-struktur
    Monitor Service (Huvudkomponent)
        Ansvarar fÃ¶r att hÃ¤mta segment och analysera kanalstatus.
        KÃ¶rs som en asynkron tjÃ¤nst som schemalagt kontrollerar kanaler.
        Kan skala genom att starta flera instanser, dÃ¤r varje instans Ã¶vervakar en eller flera kanaler.
    API Gateway / Dashboard Service
        REST API fÃ¶r att lÃ¤gga till, ta bort och hantera kanaler som ska Ã¶vervakas.
        Presenterar data till dashboarden.
        Kan anvÃ¤nda FastAPI (Python) eller Express.js (Node.js).
    Database Service
        Lagrar kanalstatus, svarstider och historik.
        PostgreSQL eller MongoDB beroende pÃ¥ databehov.
        Alternativt Redis om du bara behÃ¶ver snabb lagring av senaste status.
    Notification Service (valfri)
        Skickar notiser via Slack, e-post eller webhooks vid problem.
        Kan vara en separat container som prenumererar pÃ¥ felmeddelanden.


Hur kÃ¶rs varje kanal?
    Varje kanal kan kÃ¶ras i en egen container om du vill ha hÃ¶g skalbarhet.
    Alternativt kan en Monitor Service hantera flera kanaler parallellt och spridas ut pÃ¥ olika instanser via Kubernetes eller Docker Swarm.
    AnvÃ¤nd RabbitMQ eller Kafka om du vill skicka kanalstatus mellan tjÃ¤nster.

Exempel pÃ¥ hur det skulle fungera i molnet
    En API-anrop lÃ¤gger till en ny kanal i systemet
        API Gateway tar emot och sparar den i databasen.
        En Monitor Service-plats upptÃ¤cker att en ny kanal behÃ¶ver Ã¶vervakas.
    Monitor Service startar en process fÃ¶r att Ã¶vervaka kanalen
        Laddar manifestet och bÃ¶rjar kontrollera segment.
    Status rapporteras tillbaka till API och Dashboard
        Dashboard visar grÃ¶n, gul eller rÃ¶d status.
        Om fel upptÃ¤cks kan Notification Service skicka en varning.



Struktur fÃ¶r Monitor Service
Vi vill att tjÃ¤nsten:

    LÃ¤ser in en HLS-kanal-URL och hÃ¤mtar dess M3U8-manifest.
    Parsar manifestet och identifierar alla kvalitetsnivÃ¥er.
    HÃ¤mtar segmenten fÃ¶r att mÃ¤ta svarstid och upptÃ¤cka problem.
    Returnerar en status: âœ… GrÃ¶n, âš ï¸ Gul, âŒ RÃ¶d.

Vald teknologi
    Python (snabb utveckling, bra HTTP-stÃ¶d).
    httpx (asynkron HTTP-klient).
    m3u8 (fÃ¶r att tolka HLS-manifest).
    asyncio (fÃ¶r parallella HTTP-anrop).
    Logging istÃ¤llet fÃ¶r print (fÃ¶r framtida Docker-kompatibilitet).
    Config via miljÃ¶variabler (fÃ¶r att underlÃ¤tta Docker senare).



âœ… LÃ¤gga till fler funktioner

ğŸ“Š Spara status i en loggfil eller databas
ğŸ”„ GÃ¶ra sÃ¥ att monitoringen kÃ¶rs kontinuerligt
ğŸš¨ Skicka varningar vid fel (Slack, e-post, webhookar)
ğŸ–¥ Bygga en dashboard som visar status i realtid



PostgreSQL databas fÃ¶r konfiguration och kanallista
Usr: boris
pwd: Serpa11!
172.232.131.169:10522
database: monitor


TÃ¤nkt filstruktur fÃ¶r micro services:
hls-monitor/
â”‚â”€â”€ monitor_service/       # HLS-monitoreringstjÃ¤nsten
â”‚   â”œâ”€â”€ monitor.py         # Huvudlogik fÃ¶r att monitorera kanaler
â”‚   â”œâ”€â”€ Dockerfile         # Dockerfile fÃ¶r denna tjÃ¤nst
â”‚   â”œâ”€â”€ requirements.txt   # Python dependencies
â”‚   â”œâ”€â”€ __init__.py        # GÃ¶r mappen till en Python-modul
â”‚
â”‚â”€â”€ notifier_service/      # NotifieringstjÃ¤nsten (Slack, e-post etc.)
â”‚   â”œâ”€â”€ notifier.py        # Hanterar notifieringar
â”‚   â”œâ”€â”€ app.py             # API fÃ¶r att ta emot notifieringsanrop
â”‚   â”œâ”€â”€ Dockerfile         # Docker-konfiguration fÃ¶r notifieringstjÃ¤nsten
â”‚   â”œâ”€â”€ requirements.txt   # Python dependencies
â”‚   â”œâ”€â”€ __init__.py        # GÃ¶r mappen till en Python-modul
â”‚
â”‚â”€â”€ database_service/      # Hanterar all databaslogik
â”‚   â”œâ”€â”€ database.py        # All kommunikation med PostgreSQL
â”‚   â”œâ”€â”€ models.py          # Datamodeller fÃ¶r kanaler och settings
â”‚   â”œâ”€â”€ migrations/        # (Valfritt) FÃ¶r att hantera databasÃ¤ndringar
â”‚   â”œâ”€â”€ __init__.py        # GÃ¶r mappen till en Python-modul
â”‚
â”‚â”€â”€ config/                # Konfigurationsfiler
â”‚   â”œâ”€â”€ .env               # MiljÃ¶variabler
â”‚   â”œâ”€â”€ settings.sql        # SQL-script fÃ¶r att skapa tabeller
â”‚
â”‚â”€â”€ docker-compose.yml      # Orkestrerar microservices i Docker
â”‚â”€â”€ README.md               # Dokumentation
â”‚â”€â”€ .gitignore              # Ignorerar filer som inte ska pushas






Docker Commands

Bygg containrar: 
docker-compose build

Starta tjÃ¤nsten
docker-compose up -d # -d = detached mode

Verifiera att allt fungerar
docker ps # kollar pÃ¥ att alla tjÃ¤nster Ã¤r igÃ¥ng

Kolla att API:et Ã¤r redo:
docker exec -it monitor_service curl http://database_service_5000/health
ska ge status: ok

Kolla loggar
Monitor service: docker logs monitor_service
Database service: docker logs database_service

Kolla innehÃ¥ll i databasen: 
docker exec -it postgres_db psql -U admin -d monitor -c "SELECT * FROM settings;"

StÃ¤ng docker:
Docker-compose down #stÃ¤nger av och tar bort alla containrar, men behÃ¥ller databasvolymerna. Om man startar med docker-compose up -d sÃ¥ finns all data kvar.

docker-compose down -v # tar bort alla volymer inkl databasen- All data i databasen fÃ¶rsvinner och mÃ¥ste Ã¥teskapas frÃ¥n init.sql


docker-compose stop # pausar och kan startas igen med docker-compose start. 

